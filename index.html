npm warn exec The following package was not found and will be installed: marked@17.0.1
<h1>Markdown to Document CLI</h1>
<blockquote>
<p>🚀 전문 출판 수준의 EPUB/PDF 변환 도구 | v1.5.0</p>
</blockquote>
<p>마크다운 문서를 <strong>완벽한 품질의 EPUB/PDF</strong>로 변환하는 CLI 도구입니다. 옵시디언 플러그인 &quot;Markdown to Document Pro&quot;의 핵심 기능을 NPM/NPX 패키지로 제공합니다.</p>
<p><strong>✨ v1.5.0 업데이트 (2026-01-08)</strong>:</p>
<ul>
<li>🔧 코드 품질 개선: 163줄 코드 감소, 모듈화된 구조</li>
<li>📊 파일 미리보기: 경로, 크기, 수정일 자동 표시</li>
<li>🎯 메타데이터 자동 추출: frontmatter 제목/저자 즉시 확인</li>
<li>🔄 변환 후 액션 메뉴: 파일 열기/다른 파일 변환/종료 선택</li>
</ul>
<h2>✨ 주요 기능</h2>
<h3>📚 핵심 변환 기능</h3>
<ul>
<li><strong>EPUB 3.3 / PDF</strong> 형식 지원</li>
<li><strong>자동 표지 생성</strong>: 테마별 고해상도 SVG(EPUB) 및 HTML(PDF) 표지 자동 삽입</li>
<li><strong>4가지 타이포그래피 프리셋</strong> (소설, 발표, 리뷰, 전자책)</li>
<li><strong>자동 목차 생성</strong> (계층형 네비게이션)</li>
<li><strong>챕터별 파일 분리</strong> (H1 기준)</li>
<li><strong>한글 최적화</strong>: Noto Sans/Serif KR 임베딩 및 가독성 높은 레이아웃</li>
</ul>
<h3>🎯 Obsidian Flavored Markdown 완벽 지원</h3>
<p><strong>자동 변환되는 Obsidian 문법</strong>:</p>
<ul>
<li><strong>Wikilinks</strong>: <code>[[Note]]</code>, <code>[[Note|Display]]</code>, <code>[[Note#Heading]]</code> → 표준 마크다운 링크</li>
<li><strong>이미지 임베드</strong>: <code>![[image.png]]</code>, <code>![[image.png|300]]</code> → 표준 이미지 문법</li>
<li><strong>Callouts</strong>: <code>&gt; [!note]</code>, <code>&gt; [!warning]</code> → 스타일이 적용된 blockquote</li>
<li><strong>Highlights</strong>: <code>==text==</code> → <code>&lt;mark&gt;text&lt;/mark&gt;</code></li>
<li><strong>Comments</strong>: <code>%%hidden%%</code> → 자동 제거</li>
<li><strong>Block References</strong>: <code>^block-id</code> → 자동 제거</li>
<li><strong>Heading Links</strong>: <code>[[#Heading]]</code> → 같은 페이지 앵커 링크</li>
</ul>
<p><strong>자동 감지 및 분석</strong>:</p>
<ul>
<li>Task Lists: <code>- [ ]</code>, <code>- [x]</code></li>
<li>Math (LaTeX): <code>$inline$</code>, <code>$$block$$</code></li>
<li>Mermaid Diagrams: <code>```mermaid</code></li>
<li>Tags: <code>#tag</code>, <code>#nested/tag</code></li>
<li>Footnotes: <code>[^1]</code></li>
</ul>
<h3>🔍 8개 검증 모듈 (자동 수정)</h3>
<ol>
<li><strong>Frontmatter 검증</strong>: YAML 구문 오류 자동 수정</li>
<li><strong>제목 검증</strong>: H1 중복 감지, 레벨 갭 수정</li>
<li><strong>링크 검증</strong>: Obsidian 링크 자동 변환 (<code>[[링크]]</code> → <code>[링크](링크)</code>)</li>
<li><strong>이미지 검증</strong>: 파일 존재, 크기, alt 텍스트 확인</li>
<li><strong>표 검증</strong>: 열 일관성, 헤더 자동 추가</li>
<li><strong>구문 검증</strong>: 닫히지 않은 코드 블록 자동 수정</li>
<li><strong>특수문자 검증</strong>: 이모지 처리, ASCII 다이어그램 경고</li>
<li><strong>접근성 검증</strong>: WCAG 2.1 AA 표준 준수</li>
</ol>
<h3>🎨 타이포그래피 프리셋</h3>
<table>
<thead>
<tr>
<th>프리셋</th>
<th>용도</th>
<th>특징</th>
</tr>
</thead>
<tbody><tr>
<td><strong>소설</strong></td>
<td>장편 소설, 에세이</td>
<td>16pt, 들여쓰기, 양쪽 정렬, 세리프 폰트</td>
</tr>
<tr>
<td><strong>발표</strong></td>
<td>프레젠테이션, 강의</td>
<td>18pt, 큰 글씨, 넓은 여백, 산세리프 폰트</td>
</tr>
<tr>
<td><strong>리뷰</strong></td>
<td>검토용 문서</td>
<td>15pt, 촘촘한 레이아웃, 코드 블록 강조</td>
</tr>
<tr>
<td><strong>전자책</strong></td>
<td>일반 전자책</td>
<td>14pt, 균형잡힌 레이아웃, 산세리프 폰트</td>
</tr>
</tbody></table>
<h3>🔧 고급 기능</h3>
<h4>TypographyService</h4>
<ul>
<li><strong>11개 프리셋 지원</strong>: Basic(4), Content-focused(4), Document Type(3) 카테고리별 레이아웃 최적화</li>
<li><strong>동적 CSS 생성</strong>: 타이포그래피 프리셋 기반 자동 스타일링</li>
<li><strong>한국어 최적화</strong>: <code>word-break: keep-all</code>, <code>orphans/widows</code> 제어 등 전문 출판 수준의 가독성</li>
<li><strong>한국어 폰트 스택</strong>: Noto Sans CJK KR, Noto Serif CJK KR 지원</li>
<li><strong>페이지 마진 설정</strong>: 각 프리셋별 최적화된 여백</li>
<li><strong>제목 스케일</strong>: H1-H6 비율 자동 계산</li>
<li><strong>하이픈 처리</strong>: 단어 끊기 옵션 지원</li>
</ul>
<h4>CoverService</h4>
<ul>
<li><strong>15개 테마 지원</strong>: Basic(6), Professional(3), Creative(4), Seasonal(3) 카테고리별 다양한 디자인</li>
<li><strong>EPUB 최적화</strong>: 고해상도 벡터 SVG 표지 생성 및 임베딩</li>
<li><strong>PDF 최적화</strong>: HTML Fragment 기술을 이용한 전면 페이지 레이아웃 구현</li>
<li><strong>메타데이터 연동</strong>: 입력된 제목과 저자명을 표지에 자동 반영</li>
<li><strong>99% 크기 감소</strong>: 사용된 문자만 포함하여 폰트 최적화</li>
<li><strong>캐싱 메커니즘</strong>: 재사용을 위한 폰트 캐시</li>
<li><strong>다양한 형식</strong>: WOFF2, TTF, OTF 지원</li>
<li><strong>문자 분석</strong>: 문서 내 사용된 문자 자동 추출</li>
</ul>
<h4>PandocService 통합</h4>
<ul>
<li><strong>자동 CSS 적용</strong>: 변환 시 타이포그래피 CSS 자동 적용</li>
<li><strong>임시 디렉토리 관리</strong>: 안전한 임시 파일 처리</li>
<li><strong>버전 호환성</strong>: Pandoc 2.x 및 3.x 지원</li>
</ul>
<h2>🪟 Windows 완전 초보자 가이드</h2>
<blockquote>
<p><strong>🎯 목표</strong>: 컴퓨터에 아무것도 없는 상태에서 전자책을 만들 수 있는 환경 구축</p>
</blockquote>
<h3>🍳 요리로 이해하기</h3>
<table>
<thead>
<tr>
<th>비유</th>
<th>실제</th>
<th>역할</th>
</tr>
</thead>
<tbody><tr>
<td>🔥 가스레인지</td>
<td><strong>Node.js</strong></td>
<td>프로그램 실행 환경</td>
</tr>
<tr>
<td>🍳 프라이팬</td>
<td><strong>Pandoc</strong></td>
<td>문서 변환 도구</td>
</tr>
<tr>
<td>🧑‍🍳 요리사</td>
<td><strong>NpxMagicDoc</strong></td>
<td>모든 것을 조합하는 셰프</td>
</tr>
<tr>
<td>🖨️ 오븐</td>
<td><strong>Python + WeasyPrint</strong></td>
<td>PDF 만들 때만 필요</td>
</tr>
</tbody></table>
<p><strong>💡 핵심</strong>: Node.js + Pandoc만 있으면 <strong>EPUB 변환 가능</strong>!<br>PDF도 원하면 Python + WeasyPrint 추가 설치</p>
<h3>1️⃣ Node.js 설치 (가스레인지)</h3>
<ol>
<li><a href="https://nodejs.org/">nodejs.org</a> 방문</li>
<li><strong>LTS 버전</strong> (왼쪽 초록 버튼) 다운로드</li>
<li>설치 시 <strong>&quot;Automatically install the necessary tools&quot;</strong> 체크 ☑️</li>
<li>설치 완료 후 <strong>컴퓨터 재시작</strong></li>
</ol>
<pre><code class="language-powershell"># 확인 (PowerShell에서)
node --version   # v20.x.x 나오면 성공!
</code></pre>
<h3>2️⃣ Pandoc 설치 (프라이팬)</h3>
<ol>
<li><a href="https://pandoc.org/installing.html">pandoc.org/installing.html</a> 방문</li>
<li>Windows 설치 파일 다운로드 (<code>.msi</code>)</li>
<li>더블클릭해서 설치</li>
</ol>
<pre><code class="language-powershell"># 확인 (새 PowerShell 창에서)
pandoc --version   # pandoc 3.x.x 나오면 성공!
</code></pre>
<h3>🎉 여기까지 하면 EPUB 변환 가능!</h3>
<pre><code class="language-powershell">npx markdown-to-document-cli@latest interactive
</code></pre>
<h3>3️⃣ Python 설치 (PDF용 오븐)</h3>
<blockquote>
<p>⚠️ <strong>PDF 변환에 필요합니다!</strong> (EPUB만 필요하면 건너뛰세요)</p>
</blockquote>
<ol>
<li><a href="https://www.python.org/downloads/">python.org/downloads</a> 방문</li>
<li><strong>&quot;Download Python 3.x.x&quot;</strong> 클릭</li>
<li><strong>⚠️ 매우 중요!</strong> 설치 시 <strong>&quot;Add python.exe to PATH&quot;</strong> 반드시 체크 ☑️</li>
<li>&quot;Install Now&quot; 클릭</li>
<li>컴퓨터 재시작</li>
</ol>
<pre><code class="language-powershell"># 확인
python --version   # Python 3.x.x 나오면 성공!
</code></pre>
<h3>4️⃣ [필수] WeasyPrint 설치 (PDF 엔진)</h3>
<blockquote>
<p>⚠️ <strong>PDF 변환에 필수!</strong> v1.5.7부터 Windows에서 WeasyPrint 없이 PDF 변환 시 에러가 발생합니다.</p>
</blockquote>
<pre><code class="language-powershell">pip install weasyprint
weasyprint --version   # 성공 확인
</code></pre>
<p><strong>왜 필수인가요?</strong></p>
<ul>
<li>WeasyPrint: Mac과 <strong>100% 동일한</strong> 고품질 PDF 생성</li>
<li>LaTeX (MiKTeX): HTML 태그 노출, 레이아웃 깨짐 발생</li>
<li>v1.5.7부터 Windows에서 LaTeX 자동 선택이 차단됩니다</li>
</ul>
<h4>🧯 Windows 설치 오류 (libgobject-2.0-0)</h4>
<pre><code class="language-powershell"># 오류 메시지 예시
WeasyPrint could not import some external libraries...
OSError: cannot load library &#39;libgobject-2.0-0&#39;
</code></pre>
<table>
<thead>
<tr>
<th>원인</th>
<th>해결 방법</th>
</tr>
</thead>
<tbody><tr>
<td>GTK/Pango DLL 미설치</td>
<td>1) <a href="https://www.msys2.org/">MSYS2</a> 설치 <br> 2) MSYS2 UCRT64 터미널에서 <code>pacman -Syu</code> <br> 3) <code>pacman -S mingw-w64-ucrt-x86_64-gtk3 mingw-w64-ucrt-x86_64-pango mingw-w64-ucrt-x86_64-cairo</code></td>
</tr>
<tr>
<td>PATH에 DLL 없음</td>
<td><code>C:\msys64\ucrt64\bin</code> 경로를 <strong>시스템 PATH</strong>에 추가 후 PowerShell 재시작</td>
</tr>
</tbody></table>
<pre><code class="language-powershell"># 설치 후 다시 확인
weasyprint --version
</code></pre>
<h3>🚀 바로 사용하기</h3>
<pre><code class="language-powershell"># EPUB 변환 (Node.js + Pandoc만 필요)
npx markdown-to-document-cli@latest &quot;C:\Users\사용자\문서.md&quot; --format epub

# PDF 변환 (Python + WeasyPrint 필요)
npx markdown-to-document-cli@latest &quot;C:\Users\사용자\문서.md&quot; --format pdf

# 대화형 모드 (가장 쉬움!)
npx markdown-to-document-cli@latest interactive
</code></pre>
<h3>💡 Windows 터미널 붙여넣기 팁</h3>
<p><strong>Ctrl+V가 안 될 때:</strong></p>
<table>
<thead>
<tr>
<th>방법</th>
<th>설명</th>
</tr>
</thead>
<tbody><tr>
<td><strong>마우스 오른쪽 클릭</strong></td>
<td>가장 확실한 방법! 클릭만 하면 붙여넣기</td>
</tr>
<tr>
<td><strong>Ctrl+Shift+V</strong></td>
<td>일부 최신 터미널에서 작동</td>
</tr>
<tr>
<td><strong>Windows Terminal 설치</strong></td>
<td>Microsoft Store에서 설치, Ctrl+V 기본 지원</td>
</tr>
</tbody></table>
<blockquote>
<p>💡 CMD 창 제목 표시줄 우클릭 → 속성 → &quot;Ctrl 키 바로 가기 사용&quot; 체크하면 Ctrl+V 활성화!</p>
</blockquote>
<h3>❓ 문제 해결</h3>
<table>
<thead>
<tr>
<th>오류</th>
<th>해결 방법</th>
</tr>
</thead>
<tbody><tr>
<td><code>&#39;m2d&#39; 인식 안됨</code></td>
<td><strong>npx 사용</strong>: <code>npx markdown-to-document-cli@latest interactive</code></td>
</tr>
<tr>
<td><code>&#39;node&#39; 인식 안됨</code></td>
<td>컴퓨터 재시작 후 새 PowerShell 열기</td>
</tr>
<tr>
<td><code>&#39;python&#39; 인식 안됨</code></td>
<td>Python 삭제 → 재설치 시 <strong>PATH 체크</strong></td>
</tr>
<tr>
<td><code>&#39;pip&#39; 인식 안됨</code></td>
<td>Python 재설치 필요</td>
</tr>
<tr>
<td><code>Ctrl+V 안됨</code></td>
<td>마우스 오른쪽 클릭으로 붙여넣기</td>
</tr>
</tbody></table>
<blockquote>
<p>📚 <strong>상세 가이드</strong>: <a href="./TroubleShooting.md">TroubleShooting.md</a>의 &quot;Windows 완전 초보자를 위한 설치 가이드&quot; 참조</p>
</blockquote>
<hr>
<h2>📦 설치</h2>
<h3>NPX로 바로 사용 (권장)</h3>
<pre><code class="language-bash">npx markdown-to-document-cli@latest input.md
</code></pre>
<h3>전역 설치</h3>
<pre><code class="language-bash">npm install -g markdown-to-document-cli
</code></pre>
<blockquote>
<p>⚠️ <strong>Windows 사용자 주의</strong>: 전역 설치 후 <code>m2d</code> 명령어가 인식되지 않을 수 있습니다!</p>
<p><strong>해결 방법 (택 1)</strong>:</p>
<ol>
<li><strong>npx 사용 (권장)</strong>: <code>npx markdown-to-document-cli@latest interactive</code></li>
<li><strong>PATH 추가</strong>: <code>%APPDATA%\npm</code>을 시스템 PATH에 추가 후 새 터미널 열기</li>
<li><strong>전체 경로</strong>: <code>&quot;%APPDATA%\npm\m2d.cmd&quot; interactive</code></li>
</ol>
<p>📚 상세 가이드: <a href="./TroubleShooting.md">TroubleShooting.md</a> → &quot;Windows에서 &#39;m2d&#39; 인식 안됨&quot; 참조</p>
</blockquote>
<h3>로컬 설치</h3>
<pre><code class="language-bash">npm install markdown-to-document-cli
</code></pre>
<h2>🚀 사용법</h2>
<h3>📁 파일 경로 입력 방법</h3>
<p><strong>올바른 경로 입력 (권장)</strong>:</p>
<pre><code class="language-bash"># 방법 1: 드래그 앤 드롭 (가장 쉬움)
# 파일을 터미널 창으로 드래그하면 경로가 자동 입력됩니다

# 방법 2: 절대 경로
# macOS/Linux
m2d /Users/username/documents/my-document.md
# Windows 로컬
m2d C:\Users\username\documents\my-document.md
# Windows 네트워크 공유 (UNC 경로)
m2d \\Mac\Home\documents\my-document.md

# 방법 3: 상대 경로
m2d ./docs/document.md
m2d ../project/README.md
</code></pre>
<p><strong>⚠️ 피해야 할 경로 입력</strong>:</p>
<pre><code class="language-bash"># ❌ 백슬래시 이스케이프가 포함된 경로
m2d /Users/username/My\ Documents/file.md

# ✅ 대신 이렇게 (따옴표 사용 또는 드래그 앤 드롭)
m2d &quot;/Users/username/My Documents/file.md&quot;
</code></pre>
<p><strong>자동 경로 정리 기능</strong>:</p>
<ul>
<li>백슬래시 이스케이프 자동 제거</li>
<li>따옴표 자동 제거</li>
<li>공백이 포함된 경로 자동 처리</li>
<li>상대 경로를 절대 경로로 자동 변환</li>
</ul>
<h3>Interactive Mode (권장)</h3>
<pre><code class="language-bash"># 대화형 모드로 실행
npx markdown-to-document-cli@latest interactive
# 또는
m2d i
</code></pre>
<p><strong>간소화된 3단계 워크플로우</strong>:</p>
<table>
<thead>
<tr>
<th>Step</th>
<th>내용</th>
</tr>
</thead>
<tbody><tr>
<td><strong>Step 1</strong></td>
<td>📄 파일 선택</td>
</tr>
<tr>
<td><strong>Step 2</strong></td>
<td>🚀 변환 모드 선택 + 자동 문서 분석</td>
</tr>
<tr>
<td><strong>Step 3</strong></td>
<td>⚡ 변환 실행</td>
</tr>
</tbody></table>
<p><strong>2가지 변환 모드</strong>:</p>
<ul>
<li><strong>⚡ 빠른 변환</strong> - 출력 형식만 선택, 스마트 기본값 자동 적용 (권장)</li>
<li><strong>⚙️ 상세 설정</strong> - 프리셋, 테마, 제목/저자 직접 선택</li>
</ul>
<p><strong>스마트 기능</strong>:</p>
<ul>
<li>문서 분석 기반 프리셋 자동 추천</li>
<li>frontmatter에서 title/author 자동 추출</li>
<li>Obsidian 문법 감지 시 자동 전처리</li>
</ul>
<h3>기본 사용법</h3>
<pre><code class="language-bash"># 기본 변환 (권장: EPUB + PDF)
npx markdown-to-document-cli@latest document.md

# PDF 변환
npx markdown-to-document-cli@latest document.md --format pdf

# EPUB + PDF 동시 변환
npx markdown-to-document-cli@latest document.md --format both

# 전역 설치 후 사용
m2d document.md
</code></pre>
<h3>옵션</h3>
<pre><code class="language-bash">m2d document.md [options]

옵션:
  -o, --output &lt;path&gt;          출력 디렉토리
  --title &lt;title&gt;              책 제목 (frontmatter title 또는 파일명 기본값)
  --author &lt;author&gt;            저자명 (frontmatter author 기본값)
  -f, --format &lt;format&gt;        출력 형식 (epub, pdf, both) [기본값: both]
  -t, --typography &lt;preset&gt;    타이포그래피 프리셋 (auto 포함) [기본값: auto]
                               Basic: novel, presentation, review, ebook
                               Content: text_heavy, table_heavy, image_heavy, balanced
                               Document: report, manual, magazine
  -c, --cover &lt;theme&gt;          표지 테마
                               Basic: apple, modern_gradient, dark_tech, nature, classic_book, minimalist
                               Professional: corporate, academic, magazine
                               Creative: sunset, ocean, aurora, rose_gold
                               Seasonal: spring, autumn, winter
  --no-validate                콘텐츠 검증 건너뛰기
  --no-auto-fix                자동 수정 비활성화
  --toc-depth &lt;number&gt;         목차 깊이 [기본값: 2]
  --no-toc                     목차 비활성화
  --pdf-engine &lt;engine&gt;        PDF 엔진 (auto, pdflatex, xelatex, weasyprint) [기본값: auto]
  --paper-size &lt;size&gt;          용지 크기 (a4, letter) [기본값: a4]
  --font-subsetting            폰트 서브세팅 활성화
  --css &lt;path&gt;                 커스텀 CSS 파일 경로
  --pandoc-path &lt;path&gt;         Pandoc 실행 파일 경로
  -v, --verbose                상세 출력
  -h, --help                   도움말 표시
</code></pre>
<h3>예제</h3>
<pre><code class="language-bash"># 소설용 타이포그래피로 EPUB 변환
m2d novel.md --format epub --typography novel

# 발표용 PDF 생성
m2d presentation.md --format pdf --typography presentation --pdf-engine weasyprint

# 출력 디렉토리 지정
m2d document.md --output ./output

# 커스텀 CSS 적용
m2d document.md --css ./custom.css

# 검증 없이 빠르게 변환
m2d document.md --no-validate --no-auto-fix

# 상세 로그 출력
m2d document.md --verbose
</code></pre>
<h3>인터랙티브 모드</h3>
<pre><code class="language-bash">m2d interactive
# 또는
m2d i
</code></pre>
<p>인터랙티브 모드는 사용자 친화적인 프롬프트를 통해 변환 옵션을 선택할 수 있습니다:</p>
<ul>
<li>✅ 따옴표가 포함된 파일 경로 자동 처리</li>
<li>🎨 색상 코딩된 프롬프트와 이모지</li>
<li>📊 개선된 스피너 애니메이션</li>
<li>📦 더 나은 출력 포맷팅</li>
<li>📖 책 제목과 저자명 직접 입력 가능</li>
</ul>
<p>가이드에 따라 옵션을 선택할 수 있습니다.</p>
<h3>프리셋 및 테마 목록</h3>
<pre><code class="language-bash"># 타이포그래피 프리셋 목록
m2d list-presets

# 표지 테마 목록
m2d list-themes
</code></pre>
<h3>의존성 확인 (권장)</h3>
<p>변환을 시작하기 전에 필요한 도구들이 모두 설치되어 있는지 확인하세요:</p>
<pre><code class="language-bash">m2d check
</code></pre>
<p><strong>자동으로 확인하는 항목</strong>:</p>
<ul>
<li>✅ Node.js (필수)</li>
<li>✅ Pandoc (필수)</li>
<li>✅ PDF 엔진: WeasyPrint, XeLaTeX, PDFLaTeX 중 최소 1개</li>
<li>⚪ Python (WeasyPrint 사용 시 필요)</li>
</ul>
<p><strong>설치되지 않은 도구가 있으면</strong>:</p>
<ul>
<li>플랫폼별(macOS, Linux, Windows) 맞춤 설치 명령어 제공</li>
<li>복사해서 바로 사용할 수 있는 명령어</li>
<li>각 도구의 역할 설명</li>
</ul>
<p><strong>예시 출력</strong>:</p>
<pre><code>🔍 의존성 확인 중...

필수 의존성:
  ✅ Node.js (v20.10.0)
  ✅ Pandoc (v3.1.2)

PDF 생성 엔진 (최소 1개 필요):
  ✅ WeasyPrint (v60.1)
  ⚪ XeLaTeX - 미설치
  ⚪ PDFLaTeX - 미설치

✅ 모든 의존성이 준비되었습니다!

🚀 준비 완료! 지금 바로 문서 변환을 시작할 수 있습니다.
</code></pre>
<h2>⚙️ 필수 요구사항</h2>
<h3>Pandoc 설치</h3>
<p>Pandoc 2.19+ 이상이 필요합니다.</p>
<h4>macOS</h4>
<pre><code class="language-bash">brew install pandoc
</code></pre>
<h4>Windows</h4>
<pre><code class="language-bash">choco install pandoc
</code></pre>
<h4>Linux (Ubuntu/Debian)</h4>
<pre><code class="language-bash">sudo apt-get update
sudo apt-get install pandoc
</code></pre>
<h4>Linux (Fedora/RHEL)</h4>
<pre><code class="language-bash">sudo dnf install pandoc
</code></pre>
<h3>WeasyPrint (PDF 생성, 선택사항)</h3>
<pre><code class="language-bash">pip install weasyprint
</code></pre>
<p>⚠️ <strong>Windows 사용자</strong>: WeasyPrint는 GTK 런타임이 필요합니다!</p>
<pre><code class="language-powershell"># MSYS2 설치 후 (https://www.msys2.org/)
# MSYS2 UCRT64 터미널에서:
pacman -S mingw-w64-ucrt-x86_64-gtk3

# PATH에 C:\msys64\ucrt64\bin 추가 필요
</code></pre>
<p>자세한 내용: <a href="./TroubleShooting.md#%EB%AC%B8%EC%A0%9C-weasyprint-cannot-load-library-libgobject-%EC%98%A4%EB%A5%98-windows">TroubleShooting.md</a></p>
<h2>📝 프로그래밍 방식 사용</h2>
<pre><code class="language-javascript">import { MarkdownToDocument } from &#39;markdown-to-document-cli&#39;;

const converter = new MarkdownToDocument();

// 초기화
await converter.initialize();

// 변환
const result = await converter.convert({
  inputPath: &#39;./document.md&#39;,
  outputPath: &#39;./output&#39;,
  format: &#39;epub&#39;,
  typographyPreset: &#39;ebook&#39;,
  validateContent: true,
  autoFix: true,
});

if (result.success) {
  console.log(&#39;변환 성공!&#39;, result.epubPath);
} else {
  console.error(&#39;변환 실패:&#39;, result.errors);
}
</code></pre>
<h2>🎯 YAML Frontmatter</h2>
<p>문서 상단에 메타데이터를 추가할 수 있습니다:</p>
<pre><code class="language-yaml">---
title: 문서 제목
subtitle: 부제목
author: 저자명
language: ko
date: 2025-01-05
description: 문서 설명
isbn: 978-0-1234-5678-9
publisher: 출판사명
---

# 문서 내용
</code></pre>
<h2>🔬 검증 리포트 예시</h2>
<pre><code>=== 검증 완료 ===

✅ 수정됨: 5건
  • Obsidian 링크 3개 변환
  • 코드 블록 1개 자동 닫기
  • 제목 공백 1개 조정

⚠️ 경고: 2건
  • 긴 제목 감지 (자동 조정됨)
  • ASCII 다이어그램 (이미지 권장)

❌ 오류: 0건

총 7개 문제 발견, 5개 자동 수정
</code></pre>
<h2>📊 기술 스택</h2>
<ul>
<li><strong>언어</strong>: TypeScript 5.3+</li>
<li><strong>런타임</strong>: Node.js 18+</li>
<li><strong>변환 엔진</strong>: Pandoc 2.19+</li>
<li><strong>CLI 프레임워크</strong>: Commander.js</li>
<li><strong>PDF 엔진</strong>: WeasyPrint (선택사항)</li>
</ul>
<h2>🐛 문제 해결</h2>
<h3>❌ PDF 변환 실패: &quot;xelatex not found&quot; 또는 &quot;PDF 엔진을 찾을 수 없습니다&quot;</h3>
<p><strong>🤔 왜 이런 오류가 나올까요?</strong></p>
<p>PDF를 만들려면 **&quot;PDF 제작 엔진&quot;**이 필요합니다. 마치 빵을 굽기 위해 오븐이 필요한 것처럼요!</p>
<p>이 오류는 &quot;오븐이 없어서 빵을 구울 수 없어요&quot;라는 뜻입니다. 아래 방법 중 하나를 선택해서 해결하세요.</p>
<h4>옵션 1: WeasyPrint 설치 (추천 ⭐)</h4>
<p><strong>가장 쉽고 빠른 방법!</strong> 한글도 완벽하게 지원합니다.</p>
<pre><code class="language-bash"># Python pip 사용
pip install weasyprint

# 또는 Python 3
pip3 install weasyprint
</code></pre>
<p>💡 <strong>Python이 없다면?</strong> <a href="https://www.python.org/downloads/">python.org</a>에서 먼저 설치하세요.</p>
<h4>옵션 2: XeLaTeX 설치 (한글 최적화)</h4>
<p><strong>한글 폰트를 아름답게!</strong> 전문 출판 수준의 품질을 원한다면 이걸로!</p>
<pre><code class="language-bash"># macOS (Homebrew)
brew install --cask basictex
# 설치 후 PATH 업데이트
eval &quot;$(/usr/libexec/path_helper)&quot;

# 또는 전체 TeX Live 설치
brew install --cask mactex

# Windows
choco install miktex

# Linux (Ubuntu/Debian)
sudo apt-get install texlive-xetex texlive-fonts-recommended

# Linux (Fedora)
sudo dnf install texlive-xetex
</code></pre>
<p>⚠️ <strong>중요</strong>: 설치 후 터미널을 다시 시작하세요!<br>🪟 <strong>Windows</strong>: MiKTeX 설치 후 첫 실행 시 패키지 자동 설치를 허용하세요.</p>
<h4>옵션 3: PDFLaTeX 설치</h4>
<pre><code class="language-bash"># macOS
brew install --cask basictex

# Linux (Ubuntu/Debian)
sudo apt-get install texlive-latex-base
</code></pre>
<h4>✓ 설치 확인하기</h4>
<p>오븐이 제대로 설치되었는지 확인해 봅시다:</p>
<pre><code class="language-bash"># WeasyPrint 확인
weasyprint --version

# XeLaTeX 확인
xelatex --version

# PDFLaTeX 확인
pdflatex --version
</code></pre>
<p>버전 번호가 나오면 성공! 🎉</p>
<h4>💡 프로 팁: 특정 엔진 지정하기</h4>
<p>여러 개를 설치했다면, 원하는 엔진을 직접 선택할 수 있습니다:</p>
<pre><code class="language-bash"># 자동 선택 (기본값 - 권장)
m2d document.md --pdf-engine auto

# WeasyPrint로 PDF 만들기
m2d document.md --pdf-engine weasyprint

# XeLaTeX로 PDF 만들기
m2d document.md --pdf-engine xelatex

# PDFLaTeX로 PDF 만들기
m2d document.md --pdf-engine pdflatex
</code></pre>
<hr>
<h3>❌ 변환 실패: &quot;require is not defined&quot;</h3>
<p><strong>증상</strong>:</p>
<pre><code>✖ 변환 실패

❌ 오류:
   • require is not defined
</code></pre>
<p><strong>원인</strong>:</p>
<ul>
<li>v1.5.2 이하 버전의 ESM/CommonJS 호환성 문제</li>
</ul>
<p><strong>해결 방법</strong>:</p>
<p>최신 버전(v1.5.3 이상)으로 업데이트하세요:</p>
<pre><code class="language-bash"># 캐시 클리어 후 최신 버전 실행
npx clear-npx-cache
npx markdown-to-document-cli@latest interactive

# 또는 전역 설치 업데이트
npm uninstall -g markdown-to-document-cli
npm install -g markdown-to-document-cli
</code></pre>
<p>자세한 내용은 <a href="./TroubleShooting.md#esm-%EB%AA%A8%EB%93%88-%EC%98%A4%EB%A5%98">TroubleShooting.md</a>를 참조하세요.</p>
<hr>
<h3>Pandoc을 찾을 수 없음</h3>
<pre><code class="language-bash"># Pandoc 설치 확인
pandoc --version

# 커스텀 경로 지정
m2d document.md --pandoc-path /path/to/pandoc
</code></pre>
<p><strong>설치 방법</strong>:</p>
<ul>
<li>macOS: <code>brew install pandoc</code></li>
<li>Windows: <code>choco install pandoc</code></li>
<li>Linux (Ubuntu/Debian): <code>sudo apt-get update &amp;&amp; sudo apt-get install pandoc</code></li>
<li>Linux (Fedora/RHEL): <code>sudo dnf install pandoc</code></li>
</ul>
<hr>
<h3>Windows PowerShell 실행 정책 오류</h3>
<p><strong>증상</strong>: Windows PowerShell에서 <code>npx</code> 또는 <code>m2d</code> 실행 시 다음 오류 발생</p>
<pre><code class="language-powershell">npx : File C:\Program Files\nodejs\npx.ps1 cannot be loaded because running scripts is disabled on this system.
</code></pre>
<p><strong>원인</strong>:</p>
<ul>
<li>Windows PowerShell의 기본 실행 정책이 스크립트 실행을 차단함</li>
<li>보안 설정으로 인해 Node.js 스크립트 실행 불가</li>
</ul>
<p><strong>해결 방법</strong>:</p>
<h4><strong>옵션 1: CMD 사용 (가장 빠름, 권장)</strong></h4>
<p>PowerShell 대신 명령 프롬프트(CMD)를 사용하면 실행 정책 문제가 없습니다:</p>
<pre><code class="language-cmd"># CMD(명령 프롬프트) 실행 후
npx markdown-to-document-cli@latest interactive

# 또는 전역 설치 후
m2d interactive
</code></pre>
<h4><strong>옵션 2: 실행 정책 변경 (영구적 해결)</strong></h4>
<p>PowerShell을 <strong>관리자 권한</strong>으로 실행한 후:</p>
<pre><code class="language-powershell"># 현재 사용자에 대해 실행 정책 변경
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser

# 확인 메시지가 나오면 &#39;Y&#39; 입력
</code></pre>
<p>그 다음 일반 PowerShell에서 다시 시도:</p>
<pre><code class="language-powershell">npx markdown-to-document-cli@latest interactive
</code></pre>
<h4><strong>옵션 3: 일회성 우회 (임시 해결)</strong></h4>
<p>관리자 권한 없이 현재 세션에서만 허용:</p>
<pre><code class="language-powershell">Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope Process
npx markdown-to-document-cli@latest interactive
</code></pre>
<p><strong>💡 권장</strong>: Windows 사용자는 **CMD(명령 프롬프트)**를 사용하는 것이 가장 간단합니다.</p>
<hr>
<h3>파일 경로 오류</h3>
<p><strong>증상</strong>: &quot;파일을 찾을 수 없습니다&quot; 또는 경로에 백슬래시(<code>\</code>)가 포함됨</p>
<p><strong>해결 방법</strong>:</p>
<ol>
<li><p><strong>드래그 앤 드롭 사용</strong> (가장 쉬움)</p>
<ul>
<li>파일을 터미널 창으로 드래그하세요</li>
<li>경로가 자동으로 입력됩니다</li>
</ul>
</li>
<li><p><strong>따옴표로 감싸기</strong></p>
<pre><code class="language-bash">m2d &quot;/Users/username/My Documents/file.md&quot;
</code></pre>
</li>
<li><p><strong>백슬래시 제거</strong></p>
<pre><code class="language-bash"># ❌ 잘못된 예
m2d /Users/username/My\ Documents/file.md

# ✅ 올바른 예
m2d &quot;/Users/username/My Documents/file.md&quot;
</code></pre>
</li>
</ol>
<p><strong>자동 수정 기능</strong>: CLI가 자동으로 경로를 정리하고 검증합니다.</p>
<h3>이미지를 찾을 수 없음</h3>
<p>이미지 파일이 마크다운 파일과 동일한 디렉토리 또는 <code>images/</code>, <code>attachments/</code>, <code>assets/</code>, <code>media/</code> 폴더에 있는지 확인하세요.</p>
<p><strong>지원하는 이미지 형식</strong>: PNG, JPG/JPEG, GIF, SVG, WebP</p>
<hr>
<h3>📚 더 많은 문제 해결</h3>
<p>이미지 오류, 한글 깨짐, 검증 문제 등 다양한 상황에 대한 해결책은 <a href="./TroubleShooting.md">전체 문제 해결 가이드</a>를 참고하세요.</p>
<h2>📄 라이선스</h2>
<p>MIT License - <a href="LICENSE">LICENSE</a> 파일 참조</p>
<h2>🙏 감사의 말</h2>
<ul>
<li><a href="https://obsidian.md">Obsidian</a> 팀의 훌륭한 플랫폼</li>
<li><a href="https://pandoc.org">Pandoc</a> 개발자들</li>
<li>원본 옵시디언 플러그인 <a href="https://github.com/bluelion79/obsidian-markdown-to-document">Markdown to Document Pro</a></li>
</ul>
<h2>📧 문의</h2>
<ul>
<li><strong>GitHub</strong>: <a href="https://github.com/goodlookingprokim">@goodlookingprokim</a></li>
<li><strong>Repository</strong>: <a href="https://github.com/goodlookingprokim/markdown-to-document-cli">https://github.com/goodlookingprokim/markdown-to-document-cli</a></li>
<li><strong>Email</strong>: <a href="mailto:edulovesai@gmail.com">edulovesai@gmail.com</a></li>
</ul>
<hr>
<p><strong>Made with ❤️ by 잘생김프로쌤</strong></p>

